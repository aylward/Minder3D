standard_anatomy_colormap = {
    'background': [0, 0, 0, 0],
    'tissue': [128, 174, 128],
    'bone': [241, 214, 145],
    'skin': [177, 122, 101],
    'connective_tissue': [111, 184, 210],
    'blood': [216, 101, 79],
    'organ': [221, 130, 101],
    'mass': [144, 238, 144],
    'muscle': [192, 104, 88],
    'foreign_object': [220, 245, 20],
    'waste': [78, 63, 0],
    'teeth': [255, 250, 220],
    'fat': [230, 220, 70],
    'gray_matter': [200, 200, 235],
    'white_matter': [250, 250, 210],
    'nerve': [244, 214, 49],
    'vein': [0, 151, 206],
    'artery': [216, 101, 79],
    'capillary': [183, 156, 220],
    'ligament': [183, 214, 211],
    'tendon': [152, 189, 207],
    'cartilage': [111, 184, 210],
    'meniscus': [178, 212, 242],
    'lymph_node': [68, 172, 100],
    'lymphatic_vessel': [111, 197, 131],
    'cerebro-spinal_fluid': [85, 188, 255],
    'bile': [0, 145, 30],
    'urine': [214, 230, 130],
    'feces': [78, 63, 0],
    'gas': [218, 255, 255],
    'fluid': [170, 250, 250],
    'edema': [140, 224, 228],
    'bleeding': [188, 65, 28],
    'necrosis': [216, 191, 216],
    'clot': [145, 60, 66],
    'embolism': [150, 98, 83],
    'head': [177, 122, 101],
    'central_nervous_system': [244, 214, 49],
    'brain': [250, 250, 225],
    'gray_matter_of_brain': [200, 200, 215],
    'telencephalon': [68, 131, 98],
    'cerebral_cortex': [128, 174, 128],
    'right_frontal_lobe': [83, 146, 164],
    'left_frontal_lobe': [83, 146, 164],
    'right_temporal_lobe': [162, 115, 105],
    'left_temporal_lobe': [162, 115, 105],
    'right_parietal_lobe': [141, 93, 137],
    'left_parietal_lobe': [141, 93, 137],
    'right_occipital_lobe': [182, 166, 110],
    'left_occipital_lobe': [182, 166, 110],
    'right_insular_lobe': [188, 135, 166],
    'left_insular_lobe': [188, 135, 166],
    'right_limbic_lobe': [154, 150, 201],
    'left_limbic_lobe': [154, 150, 201],
    'right_striatum': [177, 140, 190],
    'left_striatum': [177, 140, 190],
    'right_caudate_nucleus': [30, 111, 85],
    'left_caudate_nucleus': [30, 111, 85],
    'right_putamen': [210, 157, 166],
    'left_putamen': [210, 157, 166],
    'right_pullidum': [48, 129, 126],
    'left_pallidum': [48, 129, 126],
    'right_amygdaloid_complex': [98, 153, 112],
    'left_amygdaloid_complex': [98, 153, 112],
    'diencephalon': [69, 110, 53],
    'thalamus': [166, 113, 137],
    'right_thalamus': [122, 101, 38],
    'left_thalamus': [122, 101, 38],
    'pineal_gland': [253, 135, 192],
    'midbrain': [145, 92, 109],
    'substantia_nigra': [46, 101, 131],
    'right_substantia_nigra': [0, 108, 112],
    'left_substantia_nigra': [0, 108, 112],
    'cerebral_white_matter': [250, 250, 225],
    'right_superior_longitudinal_fasciculus': [127, 150, 88],
    'left_superior_longitudinal_fasciculus': [127, 150, 88],
    'right_inferior_longitudinal_fasciculus': [159, 116, 163],
    'left_inferior_longitudinal_fasciculus': [159, 116, 163],
    'right_arcuate_fasciculus': [125, 102, 154],
    'left_arcuate_fasciculus': [125, 102, 154],
    'right_uncinate_fasciculus': [106, 174, 155],
    'left_uncinate_fasciculus': [106, 174, 155],
    'right_cingulum_bundle': [154, 146, 83],
    'left_cingulum_bundle': [154, 146, 83],
    'projection_fibers': [126, 126, 55],
    'right_corticospinal_tract': [201, 160, 133],
    'left_corticospinal_tract': [201, 160, 133],
    'right_optic_radiation': [78, 152, 141],
    'left_optic_radiation': [78, 152, 141],
    'right_medial_lemniscus': [174, 140, 103],
    'left_medial_lemniscus': [174, 140, 103],
    'right_superior_cerebellar_peduncle': [139, 126, 177],
    'left_superior_cerebellar_peduncle': [139, 126, 177],
    'right_middle_cerebellar_peduncle': [148, 120, 72],
    'left_middle_cerebellar_peduncle': [148, 120, 72],
    'right_inferior_cerebellar_peduncle': [186, 135, 135],
    'left_inferior_cerebellar_peduncle': [186, 135, 135],
    'optic_chiasm': [99, 106, 24],
    'right_optic_tract': [156, 171, 108],
    'left_optic_tract': [156, 171, 108],
    'right_fornix': [64, 123, 147],
    'left_fornix': [64, 123, 147],
    'commissural_fibers': [138, 95, 74],
    'corpus_callosum': [97, 113, 158],
    'posterior_commissure': [126, 161, 197],
    'cerebellar_white_matter': [194, 195, 164],
    'CSF_space': [85, 188, 255],
    'ventricles_of_brain': [88, 106, 215],
    'right_lateral_ventricle': [88, 106, 215],
    'left_lateral_ventricle': [88, 106, 215],
    'right_third_ventricle': [88, 106, 215],
    'left_third_ventricle': [88, 106, 215],
    'cerebral_aqueduct': [88, 106, 215],
    'fourth_ventricle': [88, 106, 215],
    'subarachnoid_space': [88, 106, 215],
    'spinal_cord': [244, 214, 49],
    'gray_matter_of_spinal_cord': [200, 200, 215],
    'white_matter_of_spinal_cord': [250, 250, 225],
    'endocrine_system_of_brain': [82, 174, 128],
    'pituitary_gland': [57, 157, 110],
    'adenohypophysis': [60, 143, 83],
    'neurohypophysis': [92, 162, 109],
    'meninges': [255, 244, 209],
    'dura_mater': [255, 244, 209],
    'arachnoid': [255, 244, 209],
    'pia_mater': [255, 244, 209],
    'muscles_of_head': [201, 121, 77],
    'salivary_glands': [70, 163, 117],
    'lips': [188, 91, 95],
    'nose': [177, 122, 101],
    'tongue': [166, 84, 94],
    'soft_palate': [182, 105, 107],
    'right_inner_ear': [229, 147, 118],
    'left_inner_ear': [229, 147, 118],
    'right_external_ear': [174, 122, 90],
    'left_external_ear': [174, 122, 90],
    'right_middle_ear': [201, 112, 73],
    'left_middle_ear': [201, 112, 73],
    'right_eyeball': [194, 142, 0],
    'left_eyeball': [194, 142, 0],
    'skull': [241, 213, 144],
    'right_frontal_bone': [203, 179, 77],
    'left_frontal_bone': [203, 179, 77],
    'right_parietal_bone': [229, 204, 109],
    'left_parietal_bone': [229, 204, 109],
    'right_temporal_bone': [255, 243, 152],
    'left_temporal_bone': [255, 243, 152],
    'right_sphenoid_bone': [209, 185, 85],
    'left_sphenoid_bone': [209, 185, 85],
    'right_ethmoid_bone': [248, 223, 131],
    'left_ethmoid_bone': [248, 223, 131],
    'occipital_bone': [255, 230, 138],
    'maxilla': [196, 172, 68],
    'right_zygomatic_bone': [255, 255, 167],
    'right_lacrimal_bone': [255, 250, 160],
    'vomer_bone': [255, 237, 145],
    'right_palatine_bone': [242, 217, 123],
    'left_palatine_bone': [242, 217, 123],
    'mandible': [222, 198, 101],
    'neck': [177, 122, 101],
    'muscles_of_neck': [213, 124, 109],
    'pharynx': [184, 105, 108],
    'larynx': [150, 208, 243],
    'thyroid_gland': [62, 162, 114],
    'right_parathyroid_glands': [62, 162, 114],
    'left_parathyroid_glands': [62, 162, 114],
    'skeleton_of_neck': [242, 206, 142],
    'hyoid_bone': [250, 210, 139],
    'cervical_vertebral_column': [255, 255, 207],
    'thorax': [177, 122, 101],
    'trachea': [182, 228, 255],
    'bronchi': [175, 216, 244],
    'right_lung': [197, 165, 145],
    'left_lung': [197, 165, 145],
    'superior_lobe_of_right_lung': [172, 138, 115],
    'superior_lobe_of_left_lung': [172, 138, 115],
    'middle_lobe_of_right_lung': [202, 164, 140],
    'inferior_lobe_of_right_lung': [224, 186, 162],
    'inferior_lobe_of_left_lung': [224, 186, 162],
    'pleura': [255, 245, 217],
    'heart': [206, 110, 84],
    'right_atrium': [210, 115, 89],
    'left_atrium': [203, 108, 81],
    'atrial_septum': [233, 138, 112],
    'ventricular_septum': [195, 100, 73],
    'right_ventricle_of_heart': [181, 85, 57],
    'left_ventricle_of_heart': [152, 55, 13],
    'mitral_valve': [159, 63, 27],
    'tricuspid_valve': [166, 70, 38],
    'aortic_valve': [218, 123, 97],
    'pulmonary_valve': [225, 130, 104],
    'aorta': [224, 97, 76],
    'pericardium': [255, 244, 209],
    'pericardial_cavity': [184, 122, 154],
    'esophagus': [211, 171, 143],
    'thymus': [47, 150, 103],
    'mediastinum': [255, 244, 209],
    'skin_of_thoracic_wall': [173, 121, 88],
    'muscles_of_thoracic_wall': [188, 95, 76],
    'skeleton_of_thorax': [255, 239, 172],
    'thoracic_vertebral_column': [226, 202, 134],
    'ribs': [253, 232, 158],
    'sternum': [244, 217, 154],
    'right_clavicle': [205, 179, 108],
    'left_clavicle': [205, 179, 108],
    'abdominal_cavity': [186, 124, 161],
    'abdomen': [177, 122, 101],
    'peritoneum': [255, 255, 220],
    'omentum': [234, 234, 194],
    'peritoneal_cavity': [204, 142, 178],
    'retroperitoneal_space': [180, 119, 153],
    'stomach': [216, 132, 105],
    'duodenum': [255, 253, 229],
    'small_bowel': [205, 167, 142],
    'colon': [204, 168, 143],
    'anus': [255, 224, 199],
    'liver': [221, 130, 101],
    'biliary_tree': [0, 145, 30],
    'gallbladder': [139, 150, 98],
    'pancreas': [249, 180, 111],
    'spleen': [157, 108, 162],
    'urinary_system': [203, 136, 116],
    'right_kidney': [185, 102, 83],
    'left_kidney': [185, 102, 83],
    'right_ureter': [247, 182, 164],
    'left_ureter': [247, 182, 164],
    'urinary_bladder': [222, 154, 132],
    'urethra': [124, 186, 223],
    'right_adrenal_gland': [249, 186, 150],
    'left_adrenal_gland': [249, 186, 150],
    'female_internal_genitalia': [244, 170, 147],
    'uterus': [255, 181, 158],
    'right_fallopian_tube': [255, 190, 165],
    'left_fallopian_tube': [227, 153, 130],
    'right_ovary': [213, 141, 113],
    'left_ovary': [213, 141, 113],
    'vagina': [193, 123, 103],
    'male_internal_genitalia': [216, 146, 127],
    'prostate': [230, 158, 140],
    'right_seminal_vesicle': [245, 172, 147],
    'left_seminal_vesicle': [245, 172, 147],
    'right_deferent_duct': [241, 172, 151],
    'left_deferent_duct': [241, 172, 151],
    'skin_of_abdominal_wall': [177, 124, 92],
    'muscles_of_abdominal_wall': [171, 85, 68],
    'skeleton_of_abdomen': [217, 198, 131],
    'lumbar_vertebral_column': [212, 188, 102],
    'female_external_genitalia': [185, 135, 134],
    'male_external_genitalia': [185, 135, 134],
    'skeleton_of_upper_limb': [198, 175, 125],
    'muscles_of_upper_limb': [194, 98, 79],
    'right_upper_limb': [177, 122, 101],
    'left_upper_limb': [177, 122, 101],
    'right_shoulder': [177, 122, 101],
    'left_shoulder': [177, 122, 101],
    'right_arm': [177, 122, 101],
    'left_arm': [177, 122, 101],
    'right_elbow': [177, 122, 101],
    'left_elbow': [177, 122, 101],
    'right_forearm': [177, 122, 101],
    'left_forearm': [177, 122, 101],
    'right_wrist': [177, 122, 101],
    'left_wrist': [177, 122, 101],
    'right_hand': [177, 122, 101],
    'left_hand': [177, 122, 101],
    'skeleton_of_lower_limb': [255, 238, 170],
    'muscles_of_lower_limb': [206, 111, 93],
    'right_lower_limb': [177, 122, 101],
    'left_lower_limb': [177, 122, 101],
    'right_hip': [177, 122, 101],
    'left_hip': [177, 122, 101],
    'right_thigh': [177, 122, 101],
    'left_thigh': [177, 122, 101],
    'right_knee': [177, 122, 101],
    'left_knee': [177, 122, 101],
    'right_leg': [177, 122, 101],
    'left_leg': [177, 122, 101],
    'right_foot': [177, 122, 101],
    'left_foot': [177, 122, 101],
    'peripheral_nervous_system': [216, 186, 0],
    'autonomic_nerve': [255, 226, 77],
    'sympathetic_trunk': [255, 243, 106],
    'cranial_nerves': [255, 234, 92],
    'vagus_nerve': [240, 210, 35],
    'peripheral_nerve': [224, 194, 0],
    'circulatory_system': [213, 99, 79],
    'systemic_arterial_system': [217, 102, 81],
    'systemic_venous_system': [0, 147, 202],
    'pulmonary_arterial_system': [0, 122, 171],
    'pulmonary_venous_system': [186, 77, 64],
    'lymphatic_system': [111, 197, 131],
    'needle': [240, 255, 30],
    'region_0': [185, 232, 61],
    'region_1': [0, 226, 255],
    'region_2': [251, 159, 255],
    'region_3': [230, 169, 29],
    'region_4': [0, 194, 113],
    'region_5': [104, 160, 249],
    'region_6': [221, 108, 158],
    'region_7': [137, 142, 0],
    'region_8': [230, 70, 0],
    'region_9': [0, 147, 0],
    'region_10': [0, 147, 248],
    'region_11': [231, 0, 206],
    'region_12': [129, 78, 0],
    'region_13': [0, 116, 0],
    'region_14': [0, 0, 255],
    'region_15': [157, 0, 0],
    'unknown': [100, 100, 130],
    'cyst': [205, 205, 100],
}
standard_anatomy_colormap_scale_factor = 255.0

short_colormap = {
    'Background': [0, 0, 0],
    'Red': [225, 0, 0],
    'orange': [225, 165, 0],
    'yellow': [200, 200, 0],
    'Green': [0, 200, 0],
    'Blue': [0, 0, 200],
    'indigo': [75, 0, 130],
    'purple': [128, 0, 128],
    'violet': [238, 130, 238],
    'White': [235, 235, 235],
    'Bone': [231, 197, 108],
    'Skin': [177, 122, 101],
    'Muscle': [205, 92, 92],
    'Fat': [238, 232, 170],
    'Arteries': [250, 128, 114],
    'Veins': [70, 130, 180],
    'Tumor': [144, 238, 144],
    'Structure_1': [238, 130, 238],
    'Structure_2': [255, 215, 0],
    'Grey80': [204, 204, 204],
    'Grey50': [128, 128, 128],
    'Grey20': [50, 50, 50],
}
short_colormap_scale_factor = 255.0


def get_nearest_color_index_and_name(color, colormap):
    color = [int(c) for c in color]
    nearest_color = 'unknown'
    nearest_color_idx = -1
    min_distance = float('inf')
    idx = 0
    for key, value in colormap.items():
        distance = sum([(a - b) ** 2 for a, b in zip(color, value)])
        if distance < min_distance:
            min_distance = distance
            nearest_color = key
            nearest_color_idx = idx
        idx += 1
    return nearest_color_idx, nearest_color
